<!DOCTYPE html>
<html>
<head>
    <link href="./style.css" type="text/css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
</head>
<body onload="getJokes()">
<navbar>
    <button onclick="type0()">Change To Type 1</button>
    <button onclick="type1()">Change To Type 2</button>
    <button onclick="type2()">Change To Type 3</button>
</navbar>
<header>
    <h3>There are three categories of jokes: </h3>
    <ul>
        <li id="type0">Type 1: General</li>
        <li id="type1">Type 2: Programming</li>
        <li id="type2">Type 3: Knock Knock</li>
    </ul>
</header>
<main>
    <h1 class="title">Tell Me A Joke</h1>
    <button onclick="revealJoke()">Reveal Punchline</button>
    <button onclick="getJokes()">Next Joke</button>
    <p id="setup">...</p>
    <p id="punchline"></p>

</main>
<script>
    // by default set joke type to 1 i.e. general
    jokeType = 0;
    document.getElementById(`type${jokeType}`).style.color = "red";
    // set to joke type 1
    function type0(){
        document.getElementById("punchline").style.display = "none";
        // highlight the type in the list 
        document.getElementById("type0").style.color = "red";
        document.getElementById("type1").style.color = "black";
        document.getElementById("type2").style.color = "black";
        jokeType = 0
        getJokes()
    }
    // set to joke type 2
    function type1(){
        document.getElementById("punchline").style.display = "none";
        document.getElementById("type1").style.color = "red";
        document.getElementById("type0").style.color = "black";
        document.getElementById("type2").style.color = "black";
        jokeType = 1
        getJokes()
    }
    // set to joke type 3
    function type2(){
        document.getElementById("punchline").style.display = "none";
        document.getElementById("type2").style.color = "red";
        document.getElementById("type1").style.color = "black";
        document.getElementById("type0").style.color = "black";
        jokeType = 2
        getJokes()
    }
    // display the punchline to the joke
    function revealJoke() {
        // slide down animation for joke reveal
        $('#punchline').slideDown(1000)
        document.getElementById("punchline").style.display = "block";
    }
    
    // get jokes depending on the type selected by the user
    function getJokes(){
        document.getElementById("punchline").style.display = "none";
        fetch('/jokes')
            .then(response => response.json())
            .then(jokes =>  {
                randomNum = Math.floor(Math.random() * jokes[jokeType].length);
                console.log(jokeType)
                document.getElementById('setup').innerHTML = jokes[jokeType][randomNum].setup;
                document.getElementById('punchline').innerHTML = jokes[jokeType][randomNum].punchline;
            });
    }
        
        //document.getElementById('output').innerHTML = randomJoke;

</script>

</body>
</html>